<div class="index-assets">

  <%= render "assets/header" %>
  <%= flash[:upload] %>

  <% if current_user %>
    <div class="dark-box asset-upload rounded_4" style="display:none">
      <h3>Adicionar imagem</h3>
      <% form_for @image, :html => { :multipart => true } do |f| %>
        <p><%= f.file_field :image %></p>
        <p>
          <%= f.label :description, "Descrição", :class => "smooth" %><br/>
          <%= f.text_area :description %></p>
          <p style="float:left"><%= link_to_function "Cancelar", :id => "cancel-upload" %></p>
        <p style="text-align:right"><%= f.submit "Enviar", :class => "awesome blue" %></p>
      <% end %>
    </div>
  
    <div class="new-asset-button">
      <%= link_to_function "Adicionar imagem", :id => "new-image", :class => "awesome medium blue" %>
    </div>
  <% else %>
    <div class="hint" style="text-align:center">
      Você precisa <%= link_to "logar", new_user_session_path %> para efetuar upload de imagens
    </div>
    <br/>
  <% end %>

  <% for image in @images %>
    <span class="image-box">
      <p><span class='hint'>Postado por </span><%= link_to image.user.name, user_path(image.user) %></p>
      <p><%= link_to image_tag(image.image.url(:thumb)), image.image.url, :class => "image-link" %></p>
      <p><%= image.description %></p>
    </span>
  <% end %>
</div>

<script language="javascript">

  $("#new-image").click(function() {
    $(".asset-upload").toggle(); 
  });
  $("#cancel-upload").click(function() {
    $(".asset-upload").hide(); 
  });

</script>